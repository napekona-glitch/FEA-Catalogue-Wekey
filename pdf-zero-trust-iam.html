<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Génération PDF - Proposition Zero Trust & IAM</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <link rel="stylesheet" href="CSS/offre-commercial.css">
</head>
<body>
    <div class="pdf-container" id="pdfContent">
        <!-- Page 1: En-tête et Valeur -->
        <div class="pdf-page">
            <!-- En-tête -->
            <div class="pdf-header">
                <h1>Proposition Commerciale</h1>
                <div class="subtitle">Zero Trust & IAM - Sécurité & Identités</div>
                <div class="pdf-meta">
                    <div>Wekey - Architecture & Transformation</div>
                    <div>Référence : ZT-2025-001</div>
                    <div>Novembre 2025</div>
                </div>
            </div>

            <!-- Section Valeur -->
            <div class="section">
                <h2 class="section-title">Valeur & Bénéfices pour votre entreprise</h2>
                <div class="value-grid">
                    <div class="value-card">
                        <h3>Sécurité Renforcée</h3>
                        <ul>
                            <li><strong>Réduction de 70%</strong> surface d'attaque</li>
                            <li><strong>Limitation de 80%</strong> mouvements latéraux</li>
                            <li><strong>Visibilité complète</strong> sur les accès</li>
                            <li><strong>Réduction risque</strong> de compromission</li>
                        </ul>
                    </div>
                    <div class="value-card">
                        <h3>Conformité Réglementaire</h3>
                        <ul>
                            <li><strong>Conformité NIST</strong> et ANSSI</li>
                            <li><strong>Audit trails</strong> complets et traçables</li>
                            <li><strong>Rapports conformité</strong> automatisés</li>
                            <li><strong>Gestion des certifications</strong> simplifiée</li>
                        </ul>
                    </div>
                    <div class="value-card">
                        <h3>Expérience Utilisateur</h3>
                        <ul>
                            <li><strong>SSO transparent</strong> pour toutes les apps</li>
                            <li><strong>MFA adaptative</strong> contextuelle</li>
                            <li><strong>Self-service</strong> pour les demandes</li>
                            <li><strong>Productivité</strong> maintenue</li>
                        </ul>
                    </div>
                   
                </div>
            </div>
        </div>

        <!-- Page 2: Approche et Définition -->
        <div class="pdf-page">
            <!-- Section Définition -->
            <div class="section">
                <h2 class="section-title">Définition du Service</h2>
                <p style="margin-bottom: 20px; line-height: 1.6;">
                    Le Zero Trust & IAM est une approche de sécurité qui remplace le modèle périmétrique par un contrôle continu des accès, basé sur le principe "Never trust, always verify". L'IAM fournit les mécanismes d'identité et d'autorisation.
                </p>
                <div class="value-grid">
                    <div class="value-card">
                        <h3>Composants Clés</h3>
                        <ul>
                            <li><strong>Identité</strong> au centre des décisions</li>
                            <li><strong>Moindre privilège</strong> et droits minimaux</li>
                            <li><strong>Vérification continue</strong> du contexte</li>
                            <li><strong>Segmentation</strong> et micro-segmentation</li>
                        </ul>
                    </div>
                    <div class="value-card">
                        <h3>Principes Zero Trust</h3>
                        <ul>
                            <li><strong>Never trust</strong>, always verify</li>
                            <li><strong>Assumer compromission</strong> permanente</li>
                            <li><strong>Vérification explicite</strong> systématique</li>
                            <li><strong>Accès micro-segmentés</strong> et contrôlés</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Section Approche -->
            <div class="section">
                <h2 class="section-title">Notre Approche Méthodologique</h2>
                <blockquote style="font-style: italic; color: #f5a623; margin-bottom: 20px; padding: 15px; background: #fffbf0; border-left: 4px solid #f5a623; border-radius: 8px;">
                    « Nous définissons une feuille de route réaliste pour faire évoluer votre IAM et votre sécurité d'accès vers un modèle Zero Trust adapté à votre organisation. »
                </blockquote>
                <div class="timeline">
                    <div class="timeline-item">
                        <div class="timeline-title">Phase 1: Audit & Analyse Risques (2 semaines)</div>
                        <div class="timeline-content">
                            État des lieux IAM, analyse des flux, identification des vulnérabilités, cartographie des accès.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-title">Phase 2: Conception Architecture (2-3 semaines)</div>
                        <div class="timeline-content">
                            Architecture Zero Trust cible, définition politiques, sélection solutions, plan de migration.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-title">Phase 3: Déploiement Progressif (3-4 semaines)</div>
                        <div class="timeline-content">
                            Déploiement par vagues, intégration SSO, mise en place MFA, tests et validation.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-title">Phase 4: Optimisation & Monitoring (1-2 semaines)</div>
                        <div class="timeline-content">
                            Monitoring continu, ajustement politiques, formation équipes, support post-déploiement.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Page 3: Livrables et Équipe -->
        <div class="pdf-page">
            <!-- Section Livrables -->
            <div class="section">
                <h2 class="section-title">Livrables & Résultats Attendus</h2>
                <div class="value-grid">
                    <div class="value-card">
                        <h3>Livrables Techniques</h3>
                        <ul>
                            <li>Architecture Zero Trust documentée</li>
                            <li>Feuille de route migration progressive</li>
                            <li>Solution IAM unifiée et intégrée</li>
                            <li>Politiques de sécurité et d'accès</li>
                            <li>Tableaux de bord monitoring</li>
                            <li>Documentation technique complète</li>
                        </ul>
                    </div>
                    <div class="value-card">
                        <h3>Transfert de Compétences</h3>
                        <ul>
                            <li>Formation équipes sécurité</li>
                            <li>Ateliers bonnes pratiques IAM</li>
                            <li>Guide d'administration IAM</li>
                            <li>Support technique post-projet</li>
                            <li>Mentoring administrateurs</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Section Équipe -->
            <div class="section">
                <h2 class="section-title">Équipe d'Experts Mobilisés</h2>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Profil</th>
                            <th>Expertise</th>
                            <th>Jours</th>
                            <th>Rôle Principal</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Security Architect</strong></td>
                            <td>Zero Trust, IAM, NIST, ANSSI</td>
                            <td>12 jours</td>
                            <td>Conception architecture & stratégie</td>
                        </tr>
                        <tr>
                            <td><strong>IAM Specialist</strong></td>
                            <td>SSO, MFA, LDAP, SAML, OAuth</td>
                            <td>15 jours</td>
                            <td>Configuration & intégration IAM</td>
                        </tr>
                        <tr>
                            <td><strong>Security Engineer</strong></td>
                            <td>Réseaux, Segmentation, Firewalls</td>
                            <td>8 jours</td>
                            <td>Déploiement & tests techniques</td>
                        </tr>
                        <tr>
                            <td><strong>Chef de projet</strong></td>
                            <td>Sécurité, Conformité, Agile</td>
                            <td>5 jours</td>
                            <td>Coordination & suivi</td>
                        </tr>
                        <tr class="highlight">
                            <td><strong>Total</strong></td>
                            <td></td>
                            <td><strong>40 jours</strong></td>
                            <td><strong>1-2 mois de mission</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Page 4: Technologies et Tarification -->
        <div class="pdf-page">
            <!-- Section Technologies -->
            <div class="section">
                <h2 class="section-title">Stack Technologique & Solutions</h2>
                <div style="margin-bottom: 20px;">
                    <h3 style="color: #f5a623; margin-bottom: 10px;">Solutions IAM Principales</h3>
                    <div class="tech-tags">
                        <a href="https://azure.microsoft.com/fr-fr/services/active-directory/" target="_blank" class="tech-tag primary" style="background: #f5a623; color: white; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8';" onmouseout="this.style.opacity='1';">Azure AD</a>
                        <a href="https://www.okta.com/" target="_blank" class="tech-tag primary" style="background: #f5a623; color: white; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8';" onmouseout="this.style.opacity='1';">Okta</a>
                        <a href="https://auth0.com/" target="_blank" class="tech-tag primary" style="background: #f5a623; color: white; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8';" onmouseout="this.style.opacity='1';">Auth0</a>
                        <a href="https://www.pingidentity.com/" target="_blank" class="tech-tag primary" style="background: #f5a623; color: white; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8';" onmouseout="this.style.opacity='1';">Ping Identity</a>
                        <a href="https://www.keycloak.org/" target="_blank" class="tech-tag primary" style="background: #f5a623; color: white; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8';" onmouseout="this.style.opacity='1';">Keycloak</a>
                    </div>
                </div>
                <div style="margin-bottom: 20px;">
                    <h3 style="color: #f5a623; margin-bottom: 10px;">Protocoles & Standards</h3>
                    <div class="tech-tags">
                        <a href="https://en.wikipedia.org/wiki/Security_Assertion_Markup_Language" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">SAML 2.0</a>
                        <a href="https://oauth.net/" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">OAuth 2.0</a>
                        <a href="https://openid.net/connect/" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">OpenID Connect</a>
                        <a href="https://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">LDAP</a>
                        <a href="https://en.wikipedia.org/wiki/RADIUS" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">RADIUS</a>
                    </div>
                </div>
                <div style="margin-bottom: 20px;">
                    <h3 style="color: #f5a623; margin-bottom: 10px;">MFA & Authentification</h3>
                    <div class="tech-tags">
                        <a href="https://en.wikipedia.org/wiki/Time-based_one-time_password" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">TOTP</a>
                        <a href="https://webauthn.io/" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">WebAuthn</a>
                        <a href="https://fidoalliance.org/fido2/" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">FIDO2</a>
                        <a href="https://en.wikipedia.org/wiki/Biometrics" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">Biometrics</a>
                        <a href="https://en.wikipedia.org/wiki/Security_token" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">Hardware Tokens</a>
                    </div>
                </div>
                <div>
                    <h3 style="color: #f5a623; margin-bottom: 10px;">Zero Trust & Segmentation</h3>
                    <div class="tech-tags">
                        <a href="https://en.wikipedia.org/wiki/Zero-trust_network_architecture" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">ZTNA</a>
                        <a href="https://en.wikipedia.org/wiki/Microsegmentation" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">Micro-segmentation</a>
                        <a href="https://en.wikipedia.org/wiki/Software-defined_perimeter" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">SDP</a>
                        <a href="https://en.wikipedia.org/wiki/Secure_access_service_edge" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">SASE</a>
                        <a href="https://en.wikipedia.org/wiki/Cloud_access_security_broker" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">CASB</a>
                    </div>
                </div>
            </div>

            <!-- Section Tarification -->
            <div class="section">
                <h2 class="section-title">Investissement & ROI</h2>
                <!-- Section Modèle de Tarification centrée et élargie -->
                <div class="value-grid-full">
                    <article class="value-card value-card-centered">
                        <h3>Modèle de Tarification</h3>
                        <ul>
                            <li><strong>Forfait fixe</strong> : 55 000 € HT</li>
                            <li>Basé sur 40 jours d'expertise</li>
                            <li>TJM moyen : 1 375 € HT/jour</li>
                            <li>Garantie de sécurité 6 mois</li>
                            <li>Support post-projet inclus</li>
                        </ul>
                    </article>
                </div>
                    
                </div>
                
                <div class="pricing-box">
                    <h3>Investissement Total : 55 000 € HT</h3>
                    <p style="font-size: 1.1rem; margin-bottom: 20px;">Soit 1 375 € HT par jour d'expertise senior</p>
                    
                    </div>
                </div>
            </div>
        </div>

        <!-- Page 5: Calendrier et Contact -->
        <div class="pdf-page">
            <!-- Section Calendrier -->
            <div class="section">
                <h2 class="section-title">Calendrier de Déploiement</h2>
                <div class="timeline">
                    <div class="timeline-item">
                        <div class="timeline-title">Semaines 1-2: Audit & Analyse</div>
                        <div class="timeline-content">
                            Interviews stakeholders, analyse flux existants, identification vulnérabilités, cartographie accès.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-title">Semaines 3-5: Conception Architecture</div>
                        <div class="timeline-content">
                            Définition architecture Zero Trust, politiques d'accès, sélection solutions, plan migration détaillé.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-title">Semaines 6-9: Déploiement Progressif</div>
                        <div class="timeline-content">
                            Déploiement SSO, configuration MFA, intégration applications, tests par vagues successives.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-title">Semaines 10-11: Optimisation & Formation</div>
                        <div class="timeline-content">
                            Monitoring continu, ajustement politiques, formation équipes, documentation finale, support.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section KPI -->
            <div class="section">
                <h2 class="section-title">Indicateurs de Performance Clés</h2>
                <div class="value-grid">
                    <div class="value-card">
                        <h3>KPI Sécurité</h3>
                        <ul>
                            <li><strong>Taux détection</strong> menaces</li>
                            <li><strong>Temps réponse</strong> incidents</li>
                            <li><strong>Niveau conformité</strong> audits</li>
                            <li><strong>Score maturité</strong> sécurité</li>
                        </ul>
                    </div>
                    <div class="value-card">
                        <h3>KPI Opérationnels</h3>
                        <ul>
                            <li><strong>Taux adoption</strong> SSO/MFA</li>
                            <li><strong>Temps connexion</strong> utilisateurs</li>
                            <li><strong>Nombre demandes</strong> accès</li>
                            <li><strong>Satisfaction</strong> utilisateurs</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Section CTA -->
            <div class="cta-section">
                <h2>Prêt à sécuriser vos accès avec Zero Trust ?</h2>
                <p style="font-size: 1.1rem; margin-bottom: 20px;">
                    Contactez-nous dès aujourd'hui pour démarrer votre projet Zero Trust & IAM 
                    et bénéficier d'un audit gratuit de votre maturité sécurité.
                </p>
            </div>

            <!-- Contact Info -->
            <div class="contact-info">
                <p><strong>Wekey - Architecture & Transformation</strong></p>
                <p>Email : <strong>contact@wekey.fr</strong> | Téléphone : <strong>+33 1 23 45 67 89</strong></p>
                <p>Web : <strong>www.wekey.fr</strong> | LinkedIn : <strong>linkedin.com/company/wekey</strong></p>
                <p><strong>Référence proposition :</strong> ZT-2025-001</p>
                <p><strong>Date d'émission :</strong> Novembre 2025</p>
                <p><strong>Validité de l'offre :</strong> 3 mois</p>
            </div>

            <!-- Footer -->
            <div class="footer">
                <p>Cette proposition commerciale est confidentielle et destinée uniquement au destinataire.</p>
                <p>Tous nos services sont soumis à nos conditions générales de vente disponibles sur demande.</p>
            </div>
        </div>
    </div>

    <!-- Bouton de génération PDF -->
    <div class="button-container">
        <button class="btn" id="generatePdf" onclick="generatePDF()">
            <i class="fas fa-file-pdf"></i>
            Télécharger la proposition commerciale (PDF)
        </button>
    </div>

    <!-- Loading indicator -->
    <div class="loading" id="loading">
        <div class="loading-spinner"></div>
        <p>Génération du PDF en cours...</p>
    </div>

    <script>
        // Initialiser jsPDF
        const { jsPDF } = window.jspdf;

        async function generatePDF() {
            const button = document.getElementById('generatePdf');
            const loading = document.getElementById('loading');
            const pages = document.querySelectorAll('.pdf-page');
            
            // Désactiver le bouton et afficher le chargement
            button.disabled = true;
            loading.style.display = 'block';
            
            try {
                // Configuration pour le PDF
                const pdf = new jsPDF('p', 'mm', 'a4');
                const pageWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                const margin = 20;
                const contentWidth = pageWidth - (margin * 2);
                const contentHeight = pageHeight - (margin * 2);
                
                // Ajouter des métadonnées
                pdf.setProperties({
                    title: 'Proposition Commerciale - Zero Trust & IAM',
                    subject: 'Wekey - Architecture & Transformation',
                    author: 'Wekey',
                    keywords: 'Zero Trust, IAM, Sécurité, SSO, MFA',
                    creator: 'Wekey - Architecture & Transformation'
                });
                
                // Traiter chaque page séparément
                for (let i = 0; i < pages.length; i++) {
                    const page = pages[i];
                    
                    // Convertir chaque page en canvas
                    const canvas = await html2canvas(page, {
                        scale: 2,
                        useCORS: true,
                        allowTaint: true,
                        backgroundColor: '#ffffff',
                        width: page.offsetWidth,
                        height: page.offsetHeight
                    });
                    
                    const imgData = canvas.toDataURL('image/png');
                    
                    // Calculer les dimensions pour s'adapter à la page PDF
                    const imgWidth = contentWidth;
                    const imgHeight = (canvas.height * contentWidth) / canvas.width;
                    
                    // Si ce n'est pas la première page, ajouter une nouvelle page
                    if (i > 0) {
                        pdf.addPage();
                    }
                    
                    // Ajouter l'image de la page
                    pdf.addImage(imgData, 'PNG', margin, margin, imgWidth, imgHeight);
                    
                    // Ajouter un numéro de page en bas
                    pdf.setFontSize(10);
                    pdf.setTextColor(128, 128, 128);
                    pdf.text(`Page ${i + 1} / ${pages.length}`, pageWidth / 2, pageHeight - 10, { align: 'center' });
                }
                
                // Générer le nom de fichier avec date
                const date = new Date().toISOString().split('T')[0];
                const fileName = `proposition-zero-trust-iam-${date}.pdf`;
                
                // Télécharger le PDF
                pdf.save(fileName);
                
                // Afficher un message de succès
                showSuccessMessage();
                
            } catch (error) {
                console.error('Erreur lors de la génération du PDF:', error);
                showErrorMessage();
            } finally {
                // Réactiver le bouton et masquer le chargement
                button.disabled = false;
                loading.style.display = 'none';
            }
        }
        
        function showSuccessMessage() {
            const message = document.createElement('div');
            message.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #28a745;
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                font-weight: 600;
            `;
            message.innerHTML = '<i class="fas fa-check-circle"></i> PDF généré avec succès !';
            document.body.appendChild(message);
            
            setTimeout(() => {
                message.remove();
            }, 3000);
        }
        
        function showErrorMessage() {
            const message = document.createElement('div');
            message.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #dc3545;
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                font-weight: 600;
            `;
            message.innerHTML = '<i class="fas fa-exclamation-circle"></i> Erreur lors de la génération du PDF';
            document.body.appendChild(message);
            
            setTimeout(() => {
                message.remove();
            }, 3000);
        }
        
        // Fonction alternative pour les navigateurs qui ne supportent pas html2canvas
        function fallbackPDF() {
            window.print();
        }
        
        // Vérifier si les bibliothèques sont chargées
        window.addEventListener('load', function() {
            if (typeof html2canvas === 'undefined' || typeof jsPDF === 'undefined') {
                console.warn('Bibliothèques PDF non chargées, utilisation de l impression native');
                document.getElementById('generatePdf').onclick = fallbackPDF;
                document.getElementById('generatePdf').innerHTML = '<i class="fas fa-print"></i> Imprimer la proposition commerciale';
            }
        });
    </script>
</body>
</html>
