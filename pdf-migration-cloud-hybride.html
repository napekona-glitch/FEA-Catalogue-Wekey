<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Génération PDF - Proposition Migration Cloud Hybride</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <link rel="stylesheet" href="CSS/offre-commercial.css">
</head>
<body>
    <div class="pdf-container" id="pdfContent">
        <!-- Page 1: En-tête et Valeur -->
        <div class="pdf-page">
            <!-- En-tête -->
            <div class="pdf-header">
                <h1>Proposition Commerciale</h1>
                <div class="subtitle">Migration Cloud Hybride - Flexibilité & Optimisation</div>
                <div class="pdf-meta">
                    <div>Wekey - Architecture & Transformation</div>
                    <div>Référence : CH-2025-001</div>
                    <div>Novembre 2025</div>
                </div>
            </div>

            <!-- Section Valeur -->
            <div class="section">
                <h2 class="section-title">Valeur & Bénéfices pour votre entreprise</h2>
                <div class="value-grid">
                    <div class="value-card">
                        <h3>Optimisation Coûts</h3>
                        <ul>
                            <li><strong>Réduction jusqu'à 40%</strong> coûts infrastructure</li>
                            <li><strong>Pay-as-you-go</strong> pour le cloud</li>
                            <li><strong>Optimisation</strong> ressources existantes</li>
                            <li><strong>Réduction CAPEX</strong> et OPEX</li>
                        </ul>
                    </div>
                    <div class="value-card">
                        <h3>Flexibilité & Agilité</h3>
                        <ul>
                            <li><strong>Augmentation de 60%</strong> flexibilité opérationnelle</li>
                            <li><strong>Évolutivité</strong> à la demande</li>
                            <li><strong>Déploiement rapide</strong> nouveaux services</li>
                            <li><strong>Adaptation</strong> aux pics de charge</li>
                        </ul>
                    </div>
                    <div class="value-card">
                        <h3>Résilience & Sécurité</h3>
                        <ul>
                            <li><strong>Meilleure résilience</strong> infrastructure redondante</li>
                            <li><strong>Contrôle accru</strong> données sensibles</li>
                            <li><strong>Sauvegarde multi-sites</strong> automatique</li>
                            <li><strong>Conformité</strong> réglementaire garantie</li>
                        </ul>
                    </div>
                    
                </div>
            </div>
        </div>

        <!-- Page 2: Approche et Définition -->
        <div class="pdf-page">
            <!-- Section Définition -->
            <div class="section">
                <h2 class="section-title">Définition du Service</h2>
                <p style="margin-bottom: 20px; line-height: 1.6;">
                    La migration cloud hybride est une approche stratégique qui combine le meilleur du cloud public et de l'infrastructure sur site pour optimiser les coûts, la performance et la sécurité tout en gardant le contrôle sur vos données critiques.
                </p>
                <div class="value-grid">
                    <div class="value-card">
                        <h3>Composants Clés</h3>
                        <ul>
                            <li><strong>Connectivité hybride</strong> : Réseau sécurisé</li>
                            <li><strong>Gestion unifiée</strong> : Multi-cloud</li>
                            <li><strong>Orchestration</strong> : Workloads hybrides</li>
                            <li><strong>Sécurité</strong> : Zero Trust étendu</li>
                        </ul>
                    </div>
                    <div class="value-card">
                        <h3>Stratégies de Migration</h3>
                        <ul>
                            <li><strong>Rehost</strong> : Lift-and-shift simple</li>
                            <li><strong>Replatform</strong> : Optimisation partielle</li>
                            <li><strong>Refactor</strong> : Transformation complète</li>
                            <li><strong>Hybrid</strong> : Coexistence progressive</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Section Approche -->
            <div class="section">
                <h2 class="section-title">Notre Approche Méthodologique</h2>
                <blockquote style="font-style: italic; color: #f5a623; margin-bottom: 20px; padding: 15px; background: #fffbf0; border-left: 4px solid #f5a623; border-radius: 8px;">
                    « Nous concevons une stratégie cloud hybride sur mesure qui équilibre innovation, coût, sécurité et performance pour votre transformation digitale. »
                </blockquote>
                <div class="timeline">
                    <div class="timeline-item">
                        <div class="timeline-title">Phase 1: Audit & Stratégie (2-3 semaines)</div>
                        <div class="timeline-content">
                            Analyse infrastructure existante, évaluation workloads, définition stratégie hybride, sélection cloud providers.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-title">Phase 2: Architecture & Design (2-3 semaines)</div>
                        <div class="timeline-content">
                            Conception architecture hybride, plan de connectivité, définition politiques, design sécurité multi-cloud.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-title">Phase 3: Migration & Déploiement (4-6 semaines)</div>
                        <div class="timeline-content">
                            Migration progressive workloads, mise en place connectivité, déploiement outils gestion, tests et validation.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-title">Phase 4: Optimisation & Formation (2-3 semaines)</div>
                        <div class="timeline-content">
                            Optimisation coûts, monitoring performance, formation équipes, documentation, support continu.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Page 3: Livrables et Équipe -->
        <div class="pdf-page">
            <!-- Section Livrables -->
            <div class="section">
                <h2 class="section-title">Livrables & Résultats Attendus</h2>
                <div class="value-grid">
                    <div class="value-card">
                        <h3>Livrables Techniques</h3>
                        <ul>
                            <li>Architecture cloud hybride documentée</li>
                            <li>Infrastructure connectivité sécurisée</li>
                            <li>Plateforme gestion multi-cloud</li>
                            <li>Pipelines de migration automatisés</li>
                            <li>Monitoring et optimisation coûts</li>
                            <li>Politiques de sécurité hybride</li>
                        </ul>
                    </div>
                    <div class="value-card">
                        <h3>Transfert de Compétences</h3>
                        <ul>
                            <li>Formation équipes cloud hybride</li>
                            <li>Ateliers gestion multi-cloud</li>
                            <li>Guide bonnes pratiques</li>
                            <li>Support technique continu</li>
                            <li>Mentoring administrateurs</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Section Équipe -->
            <div class="section">
                <h2 class="section-title">Équipe d'Experts Mobilisés</h2>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Profil</th>
                            <th>Expertise</th>
                            <th>Jours</th>
                            <th>Rôle Principal</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Cloud Architect</strong></td>
                            <td>AWS, Azure, GCP, Multi-cloud</td>
                            <td>20 jours</td>
                            <td>Conception architecture & stratégie</td>
                        </tr>
                        <tr>
                            <td><strong>Infrastructure Engineer</strong></td>
                            <td>Réseaux, Sécurité, Virtualisation</td>
                            <td>18 jours</td>
                            <td>Déploiement & configuration</td>
                        </tr>
                        <tr>
                            <td><strong>DevOps Specialist</strong></td>
                            <td>Kubernetes, CI/CD, IaC</td>
                            <td>15 jours</td>
                            <td>Automatisation & pipelines</td>
                        </tr>
                        <tr>
                            <td><strong>Chef de projet</strong></td>
                            <td>Cloud, Transformation, Agile</td>
                            <td>6 jours</td>
                            <td>Coordination & livraison</td>
                        </tr>
                        <tr class="highlight">
                            <td><strong>Total</strong></td>
                            <td></td>
                            <td><strong>59 jours</strong></td>
                            <td><strong>2-3 mois de mission</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Page 4: Technologies et Tarification -->
        <div class="pdf-page">
            <!-- Section Technologies -->
            <div class="section">
                <h2 class="section-title">Stack Technologique & Solutions</h2>
                <div style="margin-bottom: 20px;">
                    <h3 style="color: #f5a623; margin-bottom: 10px;">Cloud Public</h3>
                    <div class="tech-tags">
                        <a href="https://aws.amazon.com/" target="_blank" class="tech-tag primary" style="background: #f5a623; color: white; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8';" onmouseout="this.style.opacity='1';">AWS</a>
                        <a href="https://azure.microsoft.com/" target="_blank" class="tech-tag primary" style="background: #f5a623; color: white; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8';" onmouseout="this.style.opacity='1';">Microsoft Azure</a>
                        <a href="https://cloud.google.com/" target="_blank" class="tech-tag primary" style="background: #f5a623; color: white; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8';" onmouseout="this.style.opacity='1';">Google Cloud Platform</a>
                        <a href="https://www.oracle.com/cloud/" target="_blank" class="tech-tag primary" style="background: #f5a623; color: white; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8';" onmouseout="this.style.opacity='1';">Oracle Cloud</a>
                        <a href="https://www.ibm.com/cloud" target="_blank" class="tech-tag primary" style="background: #f5a623; color: white; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8';" onmouseout="this.style.opacity='1';">IBM Cloud</a>
                    </div>
                </div>
                <div style="margin-bottom: 20px;">
                    <h3 style="color: #f5a623; margin-bottom: 10px;">Connectivité & Réseau</h3>
                    <div class="tech-tags">
                        <a href="https://en.wikipedia.org/wiki/Virtual_private_network" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">VPN Site-to-Site</a>
                        <a href="https://aws.amazon.com/directconnect/" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">AWS Direct Connect</a>
                        <a href="https://azure.microsoft.com/fr-fr/services/expressroute/" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">Azure ExpressRoute</a>
                        <a href="https://en.wikipedia.org/wiki/Software-defined_wide_area_network" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">SD-WAN</a>
                        <a href="https://www.cloudflare.com/" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">Cloudflare</a>
                    </div>
                </div>
                <div style="margin-bottom: 20px;">
                    <h3 style="color: #f5a623; margin-bottom: 10px;">Gestion & Orchestration</h3>
                    <div class="tech-tags">
                        <a href="https://kubernetes.io/" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">Kubernetes</a>
                        <a href="https://www.terraform.io/" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">Terraform</a>
                        <a href="https://www.ansible.com/" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">Ansible</a>
                        <a href="https://rancher.com/" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">Rancher</a>
                        <a href="https://www.portainer.io/" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">Portainer</a>
                    </div>
                </div>
                <div>
                    <h3 style="color: #f5a623; margin-bottom: 10px;">Monitoring & Sécurité</h3>
                    <div class="tech-tags">
                        <a href="https://prometheus.io/" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">Prometheus</a>
                        <a href="https://grafana.com/" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">Grafana</a>
                        <a href="https://www.elastic.co/elastic-stack" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">ELK Stack</a>
                        <a href="https://www.paloaltonetworks.com/prisma/cloud" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">Prisma Cloud</a>
                        <a href="https://www.aquasec.com/" target="_blank" class="tech-tag" style="background: #e9ecef; color: #495057; padding: 6px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 500; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.opacity='0.8'; this.style.background='#dee2e6';" onmouseout="this.style.opacity='1'; this.style.background='#e9ecef';">Aqua Security</a>
                    </div>
                </div>
            </div>

            <!-- Section Tarification -->
            <div class="section">
                <h2 class="section-title">Investissement & ROI</h2>
                <!-- Section Modèle de Tarification centrée et élargie -->
                <div class="value-grid-full">
                    <article class="value-card value-card-centered">
                        <h3>Modèle de Tarification</h3>
                        <ul>
                            <li><strong>Forfait fixe</strong> : 85 000 € HT</li>
                            <li>Basé sur 59 jours d'expertise</li>
                            <li>TJM moyen : 1 441 € HT/jour</li>
                            <li>Garantie de disponibilité 99.9%</li>
                            <li>Support post-projet inclus</li>
                        </ul>
                    </article>
                </div>
                    
                </div>
                
                <div class="pricing-box">
                    <h3>Investissement Total : 85 000 € HT</h3>
                    <p style="font-size: 1.1rem; margin-bottom: 20px;">Soit 1 441 € HT par jour d'expertise senior</p>
                    
                    </div>
                </div>
            </div>
        </div>

        <!-- Page 5: Calendrier et Contact -->
        <div class="pdf-page">
            <!-- Section Calendrier -->
            <div class="section">
                <h2 class="section-title">Calendrier de Migration</h2>
                <div class="timeline">
                    <div class="timeline-item">
                        <div class="timeline-title">Semaines 1-3: Audit & Stratégie</div>
                        <div class="timeline-content">
                            Analyse infrastructure, évaluation workloads, workshops métier, définition stratégie hybride, sélection providers.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-title">Semaines 4-6: Architecture & Design</div>
                        <div class="timeline-content">
                            Conception architecture hybride, plan connectivité, définition politiques, design sécurité multi-cloud, validation.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-title">Semaines 7-12: Migration & Déploiement</div>
                        <div class="timeline-content">
                            Migration progressive workloads, mise en place connectivité, déploiement outils gestion, tests et validation continue.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-title">Semaines 13-14: Optimisation & Formation</div>
                        <div class="timeline-content">
                            Optimisation coûts, monitoring performance, formation équipes, documentation finale, support continu.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section KPI -->
            <div class="section">
                <h2 class="section-title">Indicateurs de Performance Clés</h2>
                <div class="value-grid">
                    <div class="value-card">
                        <h3>KPI Techniques</h3>
                        <ul>
                            <li><strong>Taux migration</strong> workloads</li>
                            <li><strong>Disponibilité</strong> services hybrides</li>
                            <li><strong>Latence réseau</strong> inter-cloud</li>
                            <li><strong>Couts infrastructure</strong> optimisés</li>
                        </ul>
                    </div>
                    <div class="value-card">
                        <h3>KPI Métier</h3>
                        <ul>
                            <li><strong>Time-to-market</strong> services</li>
                            <li><strong>Satisfaction équipes</strong> IT</li>
                            <li><strong>Conformité</strong> réglementaire</li>
                            <li><strong>Agilité opérationnelle</strong> mesurée</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Section CTA -->
            <div class="cta-section">
                <h2>Prêt à optimiser votre infrastructure avec le cloud hybride ?</h2>
                <p style="font-size: 1.1rem; margin-bottom: 20px;">
                    Contactez-nous dès aujourd'hui pour démarrer votre migration cloud hybride 
                    et bénéficier d'un audit gratuit de votre infrastructure existante.
                </p>
            </div>

            <!-- Contact Info -->
            <div class="contact-info">
                <p><strong>Wekey - Architecture & Transformation</strong></p>
                <p>Email : <strong>contact@wekey.fr</strong> | Téléphone : <strong>+33 1 23 45 67 89</strong></p>
                <p>Web : <strong>www.wekey.fr</strong> | LinkedIn : <strong>linkedin.com/company/wekey</strong></p>
                <p><strong>Référence proposition :</strong> CH-2025-001</p>
                <p><strong>Date d'émission :</strong> Novembre 2025</p>
                <p><strong>Validité de l'offre :</strong> 3 mois</p>
            </div>

            <!-- Footer -->
            <div class="footer">
                <p>Cette proposition commerciale est confidentielle et destinée uniquement au destinataire.</p>
                <p>Tous nos services sont soumis à nos conditions générales de vente disponibles sur demande.</p>
            </div>
        </div>
    </div>

    <!-- Bouton de génération PDF -->
    <div class="button-container">
        <button class="btn" id="generatePdf" onclick="generatePDF()">
            <i class="fas fa-file-pdf"></i>
            Télécharger la proposition commerciale (PDF)
        </button>
    </div>

    <!-- Loading indicator -->
    <div class="loading" id="loading">
        <div class="loading-spinner"></div>
        <p>Génération du PDF en cours...</p>
    </div>

    <script>
        // Initialiser jsPDF
        const { jsPDF } = window.jspdf;

        async function generatePDF() {
            const button = document.getElementById('generatePdf');
            const loading = document.getElementById('loading');
            const pages = document.querySelectorAll('.pdf-page');
            
            // Désactiver le bouton et afficher le chargement
            button.disabled = true;
            loading.style.display = 'block';
            
            try {
                // Configuration pour le PDF
                const pdf = new jsPDF('p', 'mm', 'a4');
                const pageWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                const margin = 20;
                const contentWidth = pageWidth - (margin * 2);
                const contentHeight = pageHeight - (margin * 2);
                
                // Ajouter des métadonnées
                pdf.setProperties({
                    title: 'Proposition Commerciale - Migration Cloud Hybride',
                    subject: 'Wekey - Architecture & Transformation',
                    author: 'Wekey',
                    keywords: 'Cloud Hybride, Migration, Multi-cloud, AWS, Azure',
                    creator: 'Wekey - Architecture & Transformation'
                });
                
                // Traiter chaque page séparément
                for (let i = 0; i < pages.length; i++) {
                    const page = pages[i];
                    
                    // Convertir chaque page en canvas
                    const canvas = await html2canvas(page, {
                        scale: 2,
                        useCORS: true,
                        allowTaint: true,
                        backgroundColor: '#ffffff',
                        width: page.offsetWidth,
                        height: page.offsetHeight
                    });
                    
                    const imgData = canvas.toDataURL('image/png');
                    
                    // Calculer les dimensions pour s'adapter à la page PDF
                    const imgWidth = contentWidth;
                    const imgHeight = (canvas.height * contentWidth) / canvas.width;
                    
                    // Si ce n'est pas la première page, ajouter une nouvelle page
                    if (i > 0) {
                        pdf.addPage();
                    }
                    
                    // Ajouter l'image de la page
                    pdf.addImage(imgData, 'PNG', margin, margin, imgWidth, imgHeight);
                    
                    // Ajouter un numéro de page en bas
                    pdf.setFontSize(10);
                    pdf.setTextColor(128, 128, 128);
                    pdf.text(`Page ${i + 1} / ${pages.length}`, pageWidth / 2, pageHeight - 10, { align: 'center' });
                }
                
                // Générer le nom de fichier avec date
                const date = new Date().toISOString().split('T')[0];
                const fileName = `proposition-cloud-hybride-${date}.pdf`;
                
                // Télécharger le PDF
                pdf.save(fileName);
                
                // Afficher un message de succès
                showSuccessMessage();
                
            } catch (error) {
                console.error('Erreur lors de la génération du PDF:', error);
                showErrorMessage();
            } finally {
                // Réactiver le bouton et masquer le chargement
                button.disabled = false;
                loading.style.display = 'none';
            }
        }
        
        function showSuccessMessage() {
            const message = document.createElement('div');
            message.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #28a745;
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                font-weight: 600;
            `;
            message.innerHTML = '<i class="fas fa-check-circle"></i> PDF généré avec succès !';
            document.body.appendChild(message);
            
            setTimeout(() => {
                message.remove();
            }, 3000);
        }
        
        function showErrorMessage() {
            const message = document.createElement('div');
            message.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #dc3545;
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                font-weight: 600;
            `;
            message.innerHTML = '<i class="fas fa-exclamation-circle"></i> Erreur lors de la génération du PDF';
            document.body.appendChild(message);
            
            setTimeout(() => {
                message.remove();
            }, 3000);
        }
        
        // Fonction alternative pour les navigateurs qui ne supportent pas html2canvas
        function fallbackPDF() {
            window.print();
        }
        
        // Vérifier si les bibliothèques sont chargées
        window.addEventListener('load', function() {
            if (typeof html2canvas === 'undefined' || typeof jsPDF === 'undefined') {
                console.warn('Bibliothèques PDF non chargées, utilisation de l impression native');
                document.getElementById('generatePdf').onclick = fallbackPDF;
                document.getElementById('generatePdf').innerHTML = '<i class="fas fa-print"></i> Imprimer la proposition commerciale';
            }
        });
    </script>
</body>
</html>
